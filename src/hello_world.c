#include <pebble.h>
#include "Glyph.h"

static Window *s_window;

static void layer_update_proc( Layer *layer, GContext *context ) {
	// Get the framebuffer
	GBitmap* frameBuffer = graphics_capture_frame_buffer( context );
	
	uint32_t fontData[133] = {
		0b00100001000010000100001000000000,
		0b10000000000000101001010010100000,
		0b00000000000000000000000000000000,
		0b00000101011111010101111101010000,
		0b00000000010001110101011010001110,
		0b00101101010111000100010011010101,
		0b01000100010101010110010000000000,
		0b00110010010101000100010101100100,
		0b11010000000000001000010000100000,
		0b00000000000000000000000000000010,
		0b00100001000100001000010000010000,
		0b10000010010000010000100000100001,
		0b00001000100001000100000000001001,
		0b01010111010101001000000000000000,
		0b00000000000000100001001111100100,
		0b00100000000000000000000000000000,
		0b00000000011000110000100010000000,
		0b00000000000000001111100000000000,
		0b00000000000000000000000000000000,
		0b00011000110000000000000000100010,
		0b00010001000010001000010001000010,
		0b00001110100011001110101110011000,
		0b10111000000000000010001100001000,
		0b01000010000100001000000000000011,
		0b10100010000100010001000100011111,
		0b00000000000111010001000010011000,
		0b00110001011100000000000000100011,
		0b00101010010111110001000010000000,
		0b00001111110000111100000100001100,
		0b01011100000000000011101000011110,
		0b10001100011000101110000000000011,
		0b11100001000010001000100001000010,
		0b00000000000011101000110001011101,
		0b00011000101110000000000001110100,
		0b01100011000101111000010111000000,
		0b00000000000011000110000000000000,
		0b11000110000000000000000011000110,
		0b00000000000011000110000100010000,
		0b00010001000100010000010000010000,
		0b01000000000000000000000000011111,
		0b00000111110000000000000000100000,
		0b10000010000010001000100010000000,
		0b00000001110100010000100010001000,
		0b00000010000000000000111010001100,
		0b01101011110110110100001000101110,
		0b01110100011000111111100011000110,
		0b00100000000001111010001100011111,
		0b01000110001111100000000000011101,
		0b00011000010000100001000101110000,
		0b00000001111010001100011000110001,
		0b10001111100000000000111111000010,
		0b00011110100001000011111000000000,
		0b01111110000100001111010000100001,
		0b00000000000000011101000110000100,
		0b11100011000101110000000000010001,
		0b10001100011111110001100011000100,
		0b00000000001000010000100001000010,
		0b00010000100000000000000001000010,
		0b00010000110001100010111000000000,
		0b00100011001010100110001010010010,
		0b10001000000000010000100001000010,
		0b00010000100001111100000000001000,
		0b11101110101100011000110001100010,
		0b00000000010001110011010110011100,
		0b01100011000100000000000111010001,
		0b10001100011000110001011100000000,
		0b00011110100011000111110100001000,
		0b01000000000000000111010001100011,
		0b00011000110001011100000100000111,
		0b10100011000111110100011000110001,
		0b00000000000111010001100000111000,
		0b00110001011100000000000111110010,
		0b00010000100001000010000100000000,
		0b00001000110001100011000110001100,
		0b01011100000000000100011000110001,
		0b01010010100010000100000000000010,
		0b00110001100011000110101110111000,
		0b10000000000100010101000100001000,
		0b01000101010001000000000010001100,
		0b01100010101000100001000010000000,
		0b00000111110000100010001000100010,
		0b00011111000000000000110001000010,
		0b00010000100001000010000100001101,
		0b00000100001000001000010000010000,
		0b10000010000100110000100001000010,
		0b00010000100001000010001100010001,
		0b01010001000000000000000000000000,
		0b00000000000000000000000000000000,
		0b00001111100000000000100000100000,
		0b10000000000000000000000000000000,
		0b00000000000111110001100011001101,
		0b10100000000001000010000111101000,
		0b11000110001111100000000000000000,
		0b00000111010001100001000001111000,
		0b00000000000100001011111000110001,
		0b10001011110000000000000000000001,
		0b11010001111111000001111000000000,
		0b00001100100011100010000100001000,
		0b01000000000000000000000001111100,
		0b01100011000101111000010111010000,
		0b10000111101000110001100011000100,
		0b00000000001000000000100001000010,
		0b00010000100000000000000100000000,
		0b01000010000100001000010000100110,
		0b00100001000010010101001110010010,
		0b10001000000000000100001000010000,
		0b10000100001000011000000000000000,
		0b00000011110101011010110101101010,
		0b00000000000000000001011011001100,
		0b01100011000100000000000000000000,
		0b01110100011000110001011100000000,
		0b00000000000001111010001100011000,
		0b11111010000100000000000000011111,
		0b00011000110001011110000100001000,
		0b00000001011011001100001000010000,
		0b00000000000000000000011111000001,
		0b11000001111100000000000001000010,
		0b00111100100001000010000011000000,
		0b00000000000000100011000110001100,
		0b11011010000000000000000000010001,
		0b10001010100101000100000000000000,
		0b00000000101011010110101101010101,
		0b00000000000000000000010001010100,
		0b01000101010001000000000000000000,
		0b00100011000110001100010111100001,
		0b01110000000000011111000100010001,
		0b00011111000000000000011001000010,
		0b00010011000001000010000100000110,
		0b01000010000100001000010000100001,
		0b00001000010011000001000010000100,
		0b00011001000010000100110000000000,
		0b00001101101100000000000000000000,
		0b00000000000000000000000000000000
	};
	
	Font monaco = {
		.glyph = (Glyph) { fontData, (GPoint) { 5, 9 } },
		.scale = 2,
		.letterSpacing = 2,
		.color = GColorVividCerulean
	};
	
	int x = ( 180 - ( ( monaco.glyph.size.x * monaco.scale ) + monaco.letterSpacing ) * 11 ) >> 1;
	const int dy = ( monaco.glyph.size.y * monaco.scale + monaco.letterSpacing );
	
	drawText( "HELLO WORLD", &monaco, frameBuffer, (GPoint) { x, 90 - dy } );
	drawText( "hello world", &monaco, frameBuffer, (GPoint) { x, 90 } );
	drawText( "0123456789", &monaco, frameBuffer, (GPoint) { x, 90 + dy } );
	
	// Finally, release the framebuffer
	graphics_release_frame_buffer( context, frameBuffer );
}

static void init() {
	// Create a window and get information about the window
	s_window = window_create();
	Layer *window_layer = window_get_root_layer(s_window);
	
	layer_set_update_proc(window_layer, layer_update_proc);
	
	// Push the window, setting the window animation to 'true'
	window_stack_push(s_window, true);
}

static void deinit() {
	// Destroy the window
	window_destroy(s_window);
}

int main() {
	init();
	app_event_loop();
	deinit();
}
